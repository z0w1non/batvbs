# batvbs

## 説明
Windows 環境におけるポータビリティの高いコンソールアプリケーションを実現するために役立つ、いくつかのバッチファイルおよび VBScript プログラムのサンプルを提示します。拡張子を除いて同名のファイルらはひとつのプログラムの構成部品です。

## 概要
|BAT|VBS|概要|
|---|---|---|
|[drop.bat](./drop.bat)|[drop.vbs](./drop.vbs)|drop.bat に対してドロップされた1つ以上のファイルを drop.vbs が処理します。各行の先頭に行番号が前置され標準出力へ出力されます。|
|[logging.bat](./logging.bat)|-|任意のコマンドの出力を、実行時のタイムスタンプを後置した名前を持つログファイルへ出力します。複数回実行される可能性のあるプログラムの実行ログを上書きせずに個別に保存する必要がある場合に有効なイディオムです。また、ログファイル名の先頭部分にはバッチファイル名が使用されます。これはログファイルと実行ファイルの対応関係を自明にするために役立ちます。|
|[listhere.bat](./listhere.bat)|-|バッチファイルが格納されていてるディレクトリと同階層に存在する全てのファイルおよびディレクトリの名前を標準入力に出力します。dir コマンドのオプション /a を使用して対象の属性（ファイル・ディレクトリ・アーカイブ・隠しファイル等）を設定することができます。|
|[grepexcel.bat](./grepexcel.bat)|[grepexcel.vbs](./grepexcel.vbs)|指定されたディレクトリ以下に存在するエクセルブック(.xls/.xlsx/.xlsm)およびテキストファイルに対して一様に正規表現による文字列検索を実行します。対象がエクセルブックの場合、その全てのワークシートの全てのセルの値に対して検索を実行します。このサンプルには Excel.Application, VBScript.RegExp, Scripting.FileSystemObject など複数のCOMオブジェクトの使用例が含まれます。|
|[tokenize.bat](./tokenize.bat)|[tokenize.vbs](./tokenize.vbs)|指定されたパスの配下に存在する全てのファイルの内容を文字列として単語分割し tokenize.txt に出力します。循環再帰を回避するため、 /v オプションを指定した find コマンドにより、対象ファイルから出力ファイル自身を除外しています。これは例として、テキストエディタの入力補完に使用される辞書ファイルの自動作成等に利用できます。またこのサンプルは、処理対象とするファイルを検索する処理をバッチファイルの内容に完結させる例を示します。処理は標準入出力を介して実装されるため、例えば tokenize.vbs のみを他のプログラムから再利用したり、あるいは出力をテキストファイルではなく他のコマンドの標準入力にリダイレクトするなど、柔軟な変更を加えることができます。|
|[replacecolor.bat](./replacecolor.bat)|[replacecolor.vbs](./replacecolor.vbs)|エクセルブックに含まれる色（セルの文字色・背景色・罫線の色）を置換します。このような置換は、例えば直近の変更箇所を赤色で表現するようなドキュメント規約が運用されている場面等に役立ちます。また、このサンプルはコマンドライン引数を VBS 側で式として評価するイディオムを含みます。 Eval 関数は動的に実行コードを変更するために利用できます。これはしばしば安全性の観点から物議を醸しますが、小規模な運用においては利便に振舞います。|
|[tee.bat](./tee.vbs)|[tee.vbs](./tee.vbs)|Linux の tee コマンドを再現します。tee output-filename [/a] という書式で実行します。標準入力を標準出力および指定されたファイルの双方にリダイレクトします。 /a オプションが指定された場合、追加モードでファイル出力します。|
